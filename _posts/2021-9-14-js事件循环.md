---
layout:     post
title:      "js事件循环"
date:       2021-09-15 17:18:00
author:     "Mountain"
header-img: "img/post-bg-2015.jpg"
tags:
    - 前端综合
---

## 从一道面试题聊聊事件循环中各任务执行顺序

某大厂面试题：

```
setTimeout(function () {
  console.log("1");
}, 0);
async function async1() {
  console.log("2");
  const data = await async2();
  console.log("3");
  return data;
}
async function async2() {
  return new Promise((resolve) => {
    console.log("4");
    resolve("async2的结果");
  }).then((data) => {
    console.log("5");
    return data;
  });
}
async1().then((data) => {
  console.log("6");
  console.log(data);
});
new Promise(function (resolve) {
  console.log("7");
  resolve() // 这里如果删掉呢？
}).then(function () {
  console.log("8");
});
```

**关于js事件循环小口诀**： 有同先同，然后再异；有微先微，然后再宏；如此反复，牢记心中。

变形：

```
setTimeout(function () {
  console.log("1");
}, 0);
let sss = 999;
async function async1() {
  console.log("2");
  sss =  await async2();
  console.log(sss);
  console.log("3");
  return sss;
}
async function async2() {
  return new Promise((resolve) => {
    console.log("4");
    resolve("async2的结果");
  }).then((data) => {
    console.log("5");
    return data;
  });
}
async1().then((data) => {
  console.log("6");
  console.log(data);
});
new Promise(function (resolve) {
  console.log("7");
  resolve()
}).then(function () {
  console.log("8");
  console.log(sss);
});
```


